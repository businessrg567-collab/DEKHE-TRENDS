name: Deploy to Render

on:
  push:
    branches:
      - main
      - master
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'
          cache: 'npm'

      - name: Install dependencies
        run: npm install

      - name: Build
        run: npm run build

      - name: Check build output
        run: |
          if [ -d "dist" ]; then
            echo "✓ Build successful"
          else
            echo "✗ Build failed - dist directory not found"
            exit 1
          fi

      - name: Verify blog posts
        run: |
          echo "Verifying blog posts data..."
          if [ -f "server/blog-seed-data.ts" ]; then
            echo "✓ Blog posts seed data found"
          else
            echo "⚠ Blog posts seed data not found"
          fi

      - name: Deployment Summary
        run: |
          echo "=========================================="
          echo "  DEPLOYMENT READY"
          echo "=========================================="
          echo "✓ Code pushed to GitHub"
          echo "✓ Build successful"
          echo "✓ Ready for Render deployment"
          echo ""
          echo "Next: Configure Render to auto-deploy from this repo"

